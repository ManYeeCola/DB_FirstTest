<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <link href="css/mui.min.css" rel="stylesheet"/>
    <title></title>
	<style>
        .mui-card, .mui-card-content-inner {overflow: initial;}
        .mui-sup {color: #ff0000;background-color: #ffffff;width: 10px;}
        .mui-rep:after { content: '*';}
        .mui-comments {color: #888888;font-size: 14px;}
        .question_input {font-size: 14px;}
        .datalist_div {height: 200px;display: none;background-color: #FFFFFF;border: 1px solid #dddddd;border-top: 0;border-radius: 0 0 5px 5px;box-shadow: 0 1px 2px rgba(0,0,0,.3);}
        .datalist_ul {list-style: none;padding: 0px;margin: 0px;}
        .datalist_li {font-size: 14px;padding: 5px 10px;width:100%;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;}
        .mui-table-view-chevron .mui-table-view-cell{padding-right:10px;}
        .datalist_li:after{left:0;}
        .end-content {display: flex;align-items: center;justify-content: flex-start;flex-direction: column;}
		.mui-sup{color: #ff0000;background-color: #ffffff;width: 10px;}
		.mui-rep:after{content: '*';}
		.mui-comments{color:#888888;font-size: 14px;}
	</style>
</head>
<body>
	<header class="mui-bar mui-bar-nav">
	      <h1 class="mui-title" style="color: #0095ff;font-size: 20px;"><strong>非公12-28通用模板签到活动</strong></h1>
	</header>
	<div class="mui-content" id="commonQuestion">
		<div class="mui-card">
			<div class="mui-card-header ">
				<div>
					<sup class="mui-sup mui-rep mui-badge"></sup>
					<strong id="question_label_" class="question_label">7.所属医院</strong>
					<span class="mui-comments"></span>
				</div>
			</div>
			<div class="mui-card-content-inner ">
				<div class="mui-input-row">
					<input type="text" class="mui-input-clear question_input" id="question_" maxlength="10" value="新增">
				</div>	
				请在下方输入新医院名称：
				<div class="mui-input-row">
					<input type="text" class="mui-input-clear question_input" id="question_" maxlength="10" value="">
				</div>	
				<div class="datalist_div mui-content mui-scroll-wrapper" id='datalist_div_' style="top: 55px;width: 92.5%;left: 15px;">
					<div class="mui-scroll">
					   <ul class='datalist_ul mui-table-view mui-table-view-chevron' id='datalist_ul_'>
						<li class="datalist_li mui-table-view-cell" data-obj="" data-value="" data-hospital="" >上海市交通大学附属医院</li>
						<li class="datalist_li mui-table-view-cell" data-obj="" data-value="" data-hospital="" >上海仁爱医院</li>
						<li class="datalist_li mui-table-view-cell" data-obj="" data-value="" data-hospital="" >上海交通大学附属瑞金医院</li>
						<li class="datalist_li mui-table-view-cell" data-obj="" data-value="" data-hospital="" >上海中医药大学附属龙华医院</li>
						<li class="datalist_li mui-table-view-cell" data-obj="" data-value="" data-hospital="" >没有找到？点击新增</li>
					   </ul>
					</div>
				</div> 
			</div>
		</div>
		<div class="mui-card">
			<div class="mui-card-header ">
				<div>
					<sup class="mui-sup mui-rep mui-badge"></sup>
					<strong id="question_label_" class="question_label">8.主要从事的研究方向</strong>
					<span class="mui-comments"></span>
				</div>
			</div>
			<div class="mui-card-content-inner ">
				<div class="mui-input-row">
					<div class="mui-input-row mui-checkbox mui-left">
						<label>早癌</label>
						<input name="question_" value=""  class="" type="checkbox">
					  </div>
				</div>	
				<div class="mui-input-row">
					<div class="mui-input-row mui-checkbox mui-left">
						<label>呼吸</label>
						<input name="question_" value=""  class="" type="checkbox">
					  </div>
				</div>	
				<div class="mui-input-row">
					<div class="mui-input-row mui-checkbox mui-left">
						<label>超声</label>
						<input name="question_" value=""  class="" type="checkbox">
					  </div>
				</div>	
				<div class="mui-input-row">
					<div class="mui-input-row mui-checkbox mui-left">
						<label>小肠镜</label>
						<input name="question_" value=""  class="" type="checkbox">
					  </div>
				</div>	
			</div>
		</div>
	</div>
	<footer class="mui-bar mui-bar-footer">
		<div class="mui-text-center">
			<button class="mui-btn mui-btn-primary mui-col-sm-8 mui-col-xs-8" onclick="GenerateDom()">提交</button>
		</div>
	</footer>
</body>
    <script src="js/mui.min.js"></script>
    <script type="text/javascript" charset="utf-8">
		//mui.init();
		var atpTemplate
		window.onload=(function(){
			//GetAptTemplate()
		})
		
		function GenerateDom(){
			document.getElementById("commonQuestion").innerHTML=""
			let input=0
			let radio=1
			let checkbox=2
			var req,qtitle,questions,content;
			let template=atpTemplate.TemplateInfo
			let commonq=GetCommonData()
			var groups=[
				{ID:0 ,Name:"通用",questions:[]},
				{ID:1 ,Name:"早癌",questions:[]},
				{ID:2 ,Name:"超声",questions:[]},
				{ID:3 ,Name:"呼吸",questions:[]},
				{ID:4 ,Name:"小肠镜",questions:[]},
			]
			groups.forEach(group=>{
				group.questions=commonq.TempQuestionInfos.filter(question=>question.Group.ID==group.ID)
				group.questions.push.apply(template.TempQuestionInfos.filter(question=>question.Group.ID==group.ID))
			})
			groups[0].questions.forEach((question,index)=>{
				content=""
				req=question.Required?"mui-rep":"",
				
				qtitle=`<div>
							<sup class="mui-sup `+req+` mui-badge"></sup>
							<strong>`+(index+1)+`.`+question.Descrition+`</strong>
							<span class="mui-comments">`+((question.Type==checkbox)?"[多选]":"")+`</span>
						</div>`
				switch (question.Type){
					case input:
						content=(question.MaxLength<=50)?//当前根据文本输入框的最大长度大于50 即可
							`<div class="mui-input-row">
								<input type="text" class="mui-input-clear" id="question_`+question.ID+`"  maxlength="`+question.MaxLength+`">
							</div>`:
							`<div class="mui-input-row">
								<textarea class="mui-input-clear" id="question_`+question.ID+`" maxlength="`+question.MaxLength+`"></textarea>
							</div>`
						break;
					case radio:
						question.TempQuOptionInfos.forEach(option=>{
							content+= `<div class="mui-input-row mui-radio  mui-left">
							  <label>`+option.Descrition+`</label>
							  <input name="question_`+question.ID+`" value="`+option.ID+`" type="radio">
							</div>`
						})
						break;
					case checkbox:
						question.TempQuOptionInfos.forEach(option=>{
							content+= `<div class="mui-input-row mui-checkbox mui-left">
							  <label>`+option.Descrition+`</label>
							  <input name="question_`+question.ID+`" value="`+option.ID+`" type="checkbox">
							</div>`
						})
						break;
				}
				 
				questions=`<div class="mui-card">
								<div class="mui-card-header ">`
									+qtitle+
								`</div>
								<div class="mui-card-content-inner ">`
									+content+
								`</div>
							</div>`
				//document.getElementById("commonQuestion").insertAdjacentHTML('beforeend',questions)
				//$("#commonQuestion").append(questions)
				mui("#commonQuestion")[0].insertAdjacentHTML('beforeend',questions)
			})
			//$("#commonQuestion").append(`<footer class="mui-card-footer"></footer>`)
			//document.getElementById("commonQuestion").insertAdjacentHTML('beforeend',`<footer class="mui-card-footer"></footer>`)
			mui("#commonQuestion")[0].insertAdjacentHTML('beforeend',`<footer class="mui-card-footer"></footer>`)
		}
		function GetAptTemplate(){
			atpTemplate=mui.getJSON(
				'@Url.Action("","")',
				{category:'news'},
				function(result){
					result=JSON.parse(result)
					GenerateDom()
				}
			);
		}

		function GetCommonData(){
			mui.getJSON(
				'@Url.Action("","")',
				{category:'news'},
				function(result){
					result=JSON.parse(result)
					return result.JsonObjects
				}
			);
		}

		function SaveAnswer(){
			
			let AptAttendance={
				AptTemplateID:atpTemplate.ID,
				AptAttAnswerInfos:[
					{},
					{}
				]
			}
		}
    </script>
</html>